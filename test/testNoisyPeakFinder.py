import unittest
import sys
sys.path.insert(0, './')
import imageProcessor.noisyPeakFinder as npf

class test_noisy_peak_finder(unittest.TestCase):
    def test(self):
        x = [48.76474136094644, 50.11985634456667, 50.60632371551998, 51.10772935672255, 51.62363799656123, 51.31276644267, 51.03920062069938, 50.21951811795888, 49.4064773081425, 48.60041152089147, 48.41487374764082, 47.634021455258214, 46.861498055439924, 46.09772228646444, 46.010868281309364, 45.27692569068709, 44.553338819890925, 43.840620433565945, 43.86342439892262, 43.18564576337837, 42.5205832509386, 41.86884283091664, 42.01190307520001, 41.400483088968905, 40.80441152620633, 40.22437072223753, 40.496913462633174, 39.96248240537617, 39.44616584663204, 38.948684188300895, 39.35733730830886, 38.91015291668744, 38.48376280978771, 38.07886552931954, 38.62641583165593, 38.27531841800928, 37.94733192202055, 37.64306044943742, 38.3275357934736, 38.07886552931954, 37.8549864614954, 37.656340767525464, 38.47076812334269, 38.3275357934736, 38.2099463490856, 38.118237105091836, 39.05124837953327, 39.01281840626232, 39.0, 39.01281840626232, 40.049968789001575, 40.11234224026316, 40.19950248448356, 40.311288741492746, 41.43669871020132, 41.593268686170845, 41.773197148410844, 41.97618372363071, 43.174066289845804, 43.41658669218482, 43.68065933568311, 43.965895873961216, 45.221676218380054, 45.5411901469428, 45.880278987817846, 46.238512086787566, 47.53945729601885, 47.92702786528704, 48.33218389437829, 48.75448697299562, 50.08991914547278, 50.53711507397311, 51.0, 51.478150704935004, 52.839379254491625, 52.478567053607705, 52.15361924162119, 51.31276644267, 50.47771785649585, 49.64876634922564, 49.4064773081425, 48.60041152089147, 47.80167361086848, 47.01063709417264, 46.861498055439924, 46.09772228646444, 45.34313619501854, 44.598206241955516, 44.553338819890925, 43.840620433565945, 43.139309220245984, 42.44997055358225, 42.5205832509386, 41.86884283091664, 41.23105625617661, 40.607881008493905, 40.80441152620633, 40.22437072223753, 39.66106403010388, 39.11521443121589, 39.44616584663204, 38.948684188300895, 38.47076812334269, 38.01315561749642, 38.48376280978771, 38.07886552931954, 37.69615364994153, 37.33630940518894, 37.94733192202055, 37.64306044943742, 37.36308338453881, 37.107950630558946, 37.8549864614954, 37.656340767525464, 37.48332962798263, 37.33630940518894, 38.2099463490856, 38.118237105091836, 38.05259518088089, 38.01315561749642, 39.0, 39.01281840626232, 39.05124837953327, 39.11521443121589, 40.19950248448356, 40.311288741492746, 40.44749683231337, 40.607881008493905, 41.773197148410844, 41.97618372363071, 42.20189569201838, 42.44997055358225, 43.68065933568311, 43.965895873961216, 44.27188724235731, 44.598206241955516, 45.880278987817846, 46.238512086787566, 46.61544808322666, 47.01063709417264, 48.33218389437829, 48.75448697299562, 49.193495504995376, 49.64876634922564, 51.0, 51.478150704935004, 51.97114584074513, 52.478567053607705, 52.15361924162119, 51.31276644267, 51.03920062069938, 50.21951811795888, 49.4064773081425, 48.60041152089147, 48.41487374764082, 47.634021455258214, 46.861498055439924, 46.09772228646444, 46.010868281309364, 45.27692569068709, 44.553338819890925, 43.840620433565945, 43.86342439892262, 43.18564576337837, 42.5205832509386, 41.86884283091664, 42.01190307520001, 41.400483088968905, 40.80441152620633, 40.22437072223753, 40.496913462633174, 39.96248240537617, 39.44616584663204, 38.948684188300895, 39.35733730830886, 38.91015291668744, 38.48376280978771, 38.07886552931954, 38.62641583165593, 38.27531841800928, 37.94733192202055, 37.64306044943742, 38.3275357934736, 38.07886552931954, 37.8549864614954, 37.656340767525464, 38.47076812334269, 38.3275357934736, 38.2099463490856, 38.118237105091836, 39.05124837953327, 39.01281840626232, 39.0, 39.01281840626232, 40.049968789001575, 40.11234224026316, 40.19950248448356, 40.311288741492746, 41.43669871020132, 41.593268686170845, 41.773197148410844, 41.97618372363071, 43.174066289845804, 43.41658669218482, 43.68065933568311, 43.965895873961216, 45.221676218380054, 45.5411901469428, 45.880278987817846, 46.238512086787566, 47.53945729601885, 47.92702786528704, 48.33218389437829, 48.75448697299562, 50.08991914547278, 50.53711507397311, 51.0, 51.478150704935004, 51.97114584074513, 51.62363799656123, 50.774009099144415, 49.92995093127971, 49.09175083453431, 48.82622246293481, 48.010415536631214, 47.20169488482379, 46.400431032480725, 46.22769732530488, 45.45327270945405, 44.68780594300866, 43.93176527297759, 43.86342439892262, 43.139309220245984, 42.42640687119285, 41.72529209005013, 41.773197148410844, 41.10960958218893, 40.45985664828782, 39.824615503479755, 40.0, 39.408120990476064, 38.8329756778952, 38.27531841800928, 38.58756276314948, 38.07886552931954, 37.589892258425, 37.12142238654117, 37.57658845611187, 37.16180835212409, 36.76955262170047, 36.40054944640259, 37.0, 36.68787265568828, 36.40054944640259, 36.138621999185304, 36.87817782917155, 36.6742416417845, 36.49657518178932, 36.345563690772494, 37.21558813185679, 37.12142238654117, 37.05401462729781, 37.013511046643494, 38.0, 38.01315561749642, 38.05259518088089, 38.118237105091836, 39.20459156782532, 39.319206502675, 39.45883931389772, 39.6232255123179, 40.792156108742276, 41.0, 41.23105625617661, 41.48493702538308, 42.720018726587654, 43.01162633521314, 43.32435804486894, 43.657759905886145, 44.94441010848846, 45.31004303683677, 45.69463863518345, 46.09772228646444, 47.4236228055175, 47.853944456021594, 48.30113870293329]
        self.assertEqual(npf.count_peaks(x), 4)
        x = [49.16299421312742, 50.24937810560445, 49.36598018878993, 48.507731342539614, 47.51841748206689, 46.69047011971501, 45.70557952810576, 44.91102314577124, 44.14748010928823, 43.174066289845804, 42.44997055358225, 41.48493702538308, 40.80441152620633, 39.84971769034255, 39.21734310225516, 38.62641583165593, 37.69615364994153, 37.16180835212409, 36.24913792078372, 35.77708763999664, 35.35533905932738, 34.48187929913333, 34.132096331752024, 33.28663395418648, 33.015148038438355, 32.202484376209235, 32.01562118716424, 31.89043743820395, 31.144823004794873, 31.11269837220809, 30.4138126514911, 30.479501308256342, 30.610455730027933, 30.0, 30.23243291566195, 29.68164415931166, 30.01666203960727, 29.5296461204668, 29.966648127543394, 30.463092423455635, 30.083217912982647, 30.675723300355934, 30.364452901377952, 31.04834939252005, 31.78049716414141, 31.575306807693888, 32.38826948140329, 32.2490309931942, 33.13608305156178, 33.06055050963308, 34.0147027033899, 35.0, 35.014282800023196, 36.05551275463989, 36.124783736376884, 37.21558813185679, 38.3275357934736, 38.47076812334269, 39.6232255123179, 39.81205847478876, 41.0, 41.23105625617661, 42.44997055358225, 43.68065933568311, 43.965895873961216, 45.221676218380054, 45.5411901469428, 46.8187996428785, 48.104053883222775, 48.46648326421054, 49.76946855251722, 50.15974481593781, 51.478150704935004, 51.894122981316485, 53.225933528685054, 54.56189146281496, 55.00909015790027, 56.356011214421486, 56.824290580701486, 58.180752831155424, 59.53990258641679, 60.03332407921454, 61.40032573203501, 61.91122676865643, 63.28506932918696, 63.812224534175265, 65.19202405202648, 64.89992295835181, 64.07027391856539, 62.68173577685928, 61.85466837676846, 61.032778078668514, 60.21627686929839, 58.82176467941097, 58.008620049092706, 57.201398584300364, 55.80322571321482, 55.0, 54.20332093147061, 53.41348144429457, 52.009614495783374, 51.22499389946279, 50.44799302251776, 49.678969393496885, 48.27007354458868, 47.50789408087881, 46.75467891024384, 45.34313619501854, 44.598206241955516, 43.86342439892262, 43.139309220245984, 41.72529209005013, 41.012193308819754, 40.311288741492746, 38.897300677553446, 38.2099463490856, 37.53664875824692, 36.87817782917155, 35.4682957019364, 34.828149534535996, 34.20526275297414, 33.60059523282288, 32.202484376209235, 31.622776601683793, 31.064449134018133, 29.68164415931166, 29.154759474226502, 28.653097563788805, 28.178005607210743, 26.832815729997478, 26.40075756488817, 26.0, 24.698178070456937, 24.351591323771842, 24.041630560342615, 23.769728648009426, 22.561028345356956, 22.360679774997898, 22.20360331117452, 22.090722034374522, 21.02379604162864, 21.0, 21.02379604162864, 20.09975124224178, 20.223748416156685, 20.396078054371138, 20.615528128088304, 19.924858845171276, 20.248456731316587, 20.615528128088304, 20.12461179749811, 20.591260281974, 21.095023109728988, 21.633307652783937, 21.400934559032695, 22.02271554554524, 22.67156809750927, 23.345235059857504, 23.345235059857504, 24.08318915758459, 24.839484696748443, 25.0, 25.80697580112788, 26.627053911388696, 27.459060435491963, 27.784887978899608, 28.653097563788805, 29.5296461204668, 29.966648127543394, 30.870698080866262, 31.78049716414141, 32.69556544854363, 33.24154027718932, 34.17601498127012, 35.11409973215888, 36.05551275463989, 36.68787265568828, 37.64306044943742, 38.600518131237564, 39.293765408777, 40.26164427839479, 41.23105625617661, 42.20189569201838, 42.95346318982906, 43.93176527297759, 44.91102314577124, 45.70557952810576, 46.69047011971501, 47.67598976424087, 48.662100242385755, 49.49747468305833, 50.48762224545735, 51.478150704935004, 52.46903848937962, 53.33854141237835, 54.3323108288245, 55.326304774492215, 56.22277118748239, 57.21887800367987, 58.215118311311535, 59.21148537234985, 60.13318551349163, 61.1310068623117, 62.07253821135398, 61.032778078668514, 60.00833275470999, 59.0, 58.008620049092706, 57.0087712549569, 56.0357029044876, 55.08175741568164, 54.147945482723536, 53.150729063673246, 52.23983154643591, 51.35172830587107, 50.48762224545735, 49.64876634922564, 48.662100242385755, 47.853944456021594, 47.07440918375928, 46.32493928760188, 45.60701700396552, 44.64302857109943, 43.965895873961216, 43.32435804486894, 42.720018726587654, 41.78516483155236, 41.23105625617661, 40.718546143004666, 40.24922359499622, 39.824615503479755, 38.948684188300895, 38.58756276314948, 38.27531841800928, 38.01315561749642, 37.8021163428716, 37.013511046643494, 36.87817782917155, 36.796738985948195, 36.76955262170047, 36.069377593742864, 36.124783736376884, 36.235341863986875, 36.40054944640259, 36.61966684720111, 36.05551275463989, 36.359317925395686, 36.71511950137164, 37.12142238654117, 37.57658845611187, 37.16180835212409, 37.69615364994153, 38.27531841800928, 38.897300677553446, 38.600518131237564, 39.293765408777, 40.024992192379, 40.792156108742276, 41.593268686170845, 41.43669871020132, 42.2965719651132, 43.18564576337837, 44.10215414239989, 45.044422518220834, 45.0111097397076, 46.0, 47.01063709417264, 48.041648597857254, 48.093658625644196]
        self.assertEqual(npf.count_peaks(x), 3)
        x = [23.53720459187964, 24.331050121192877, 24.186773244895647, 24.08318915758459, 24.020824298928627, 24.0, 24.020824298928627, 24.08318915758459, 24.186773244895647, 24.331050121192877, 23.53720459187964, 23.769728648009426, 24.041630560342615, 24.351591323771842, 23.769728648009426, 24.166091947189145, 23.706539182259394, 24.186773244895647, 23.853720883753127, 23.600847442411894, 23.430749027719962, 24.08318915758459, 24.041630560342615, 24.08318915758459, 23.430749027719962, 23.600847442411894, 23.853720883753127, 24.186773244895647, 23.706539182259394, 24.166091947189145, 23.769728648009426, 24.351591323771842, 24.041630560342615, 23.769728648009426, 23.53720459187964, 24.331050121192877, 24.186773244895647, 24.08318915758459, 24.020824298928627, 24.0, 24.020824298928627, 24.08318915758459, 24.186773244895647, 24.331050121192877, 23.53720459187964, 23.769728648009426, 24.041630560342615, 24.351591323771842, 23.769728648009426, 24.166091947189145, 23.706539182259394, 24.186773244895647, 23.853720883753127, 23.600847442411894, 23.430749027719962, 24.08318915758459, 24.041630560342615, 24.08318915758459, 23.430749027719962, 23.600847442411894, 23.853720883753127, 24.186773244895647, 23.706539182259394, 24.166091947189145, 23.769728648009426, 24.351591323771842, 24.041630560342615, 23.769728648009426, 23.53720459187964, 24.331050121192877, 24.186773244895647, 24.08318915758459, 24.020824298928627, 24.0, 24.020824298928627, 24.08318915758459, 24.186773244895647, 24.331050121192877, 23.53720459187964, 23.769728648009426, 24.041630560342615, 24.351591323771842, 23.769728648009426, 24.166091947189145, 23.706539182259394, 24.186773244895647, 23.853720883753127, 23.600847442411894, 23.430749027719962, 24.08318915758459, 24.041630560342615, 24.08318915758459, 23.430749027719962, 23.600847442411894, 23.853720883753127, 24.186773244895647, 23.706539182259394, 24.166091947189145, 23.769728648009426, 24.351591323771842, 24.041630560342615, 23.769728648009426, 23.53720459187964, 24.331050121192877, 24.186773244895647, 24.08318915758459, 24.020824298928627, 24.0, 24.020824298928627, 24.08318915758459, 24.186773244895647, 24.331050121192877, 23.53720459187964, 23.769728648009426, 24.041630560342615, 24.351591323771842, 23.769728648009426, 24.166091947189145, 23.706539182259394, 24.186773244895647, 23.853720883753127, 23.600847442411894, 23.430749027719962, 24.08318915758459, 24.041630560342615, 24.08318915758459, 23.430749027719962, 23.600847442411894, 23.853720883753127, 24.186773244895647, 23.706539182259394, 24.166091947189145, 23.769728648009426, 24.351591323771842, 24.041630560342615, 23.769728648009426]
        self.assertGreater(npf.count_peaks(x), 10)

if __name__ == '__main__':
    unittest.main()
